<!DOCTYPE html>
<html lang="zh-TW">

<head>
	<script src="/morari/guest/js/head.js"></script>
	<!-- sharepage 公用頁面 -->
	<script src="/morari/guest/js/share.js"></script>

	<style>
		td {
			border: 2px black solid;
		}
	</style>

	<script>
		var url = window.location.href;
		var id = url.split("/").pop();
	</script>


	<script>
	</script>

</head>

<body style="display: none">
	<!-- Header Section Start -->
	<div class="header"></div>

	<!-- Header Section End -->

	<!-- 分離範例 -->
	<table id="result"></table>
	<div id="amenities">
		<div class="container">
			<div class="section-header">

				<h2>凹豆商城</h2>
				<p>
					<input type='button' id='selectbyuserid' value='查看購物車' onclick='selectbyuserid(uid)'>
				</p>
			</div>
			<div id="banners" class="row">
			</div>
		</div>
	</div>
	<script src="/morari/mall/js/test.js"></script>

	<!-- Footer Section Start -->
	<div class="footer"></div>
	<!-- Footer Section End -->

	<a href="#" class="back-to-top"><i class="fa fa-chevron-up"></i></a>

	<!-- Vendor JavaScript File -->
	<script src="/morari/guest/vendor/jquery/jquery.min.js"></script>
	<script src="/morari/guest/vendor/jquery/jquery-migrate.min.js" defer></script>
	<script src="/morari/guest/vendor/bootstrap/js/bootstrap.bundle.min.js" defer></script>
	<script src="/morari/guest/vendor/easing/easing.min.js" defer></script>
	<script src="/morari/guest/vendor/stickyjs/sticky.js" defer></script>
	<script src="/morari/guest/vendor/superfish/hoverIntent.js" defer></script>
	<script src="/morari/guest/vendor/superfish/superfish.min.js" defer></script>
	<script src="/morari/guest/vendor/wow/wow.min.js" defer></script>
	<script src="/morari/guest/vendor/slick/slick.min.js" defer></script>
	<script src="/morari/guest/vendor/tempusdominus/js/moment.min.js" defer></script>
	<script src="/morari/guest/vendor/tempusdominus/js/moment-timezone.min.js" defer></script>
	<script src="/morari/guest/vendor/tempusdominus/js/tempusdominus-bootstrap-4.min.js" defer></script>

	<!-- Booking Javascript File -->
	<script src="/morari/guest/js/booking.js" defer></script>
	<script src="/morari/guest/js/jqBootstrapValidation.min.js" defer></script>

	<!-- Main Javascript File -->
	<script src="/morari/guest/js/main.js" defer></script>

	<script type="text/javascript">

		var uid;
		fetch("/morari/utils/getuid")
			.then(response => response.text())
			.then(datauid => {
				// console.log(data)
				// document.getElementById("uid").value = data;
				uid = datauid;
			})

		fetch('/morari/mall/selectByPdid/' + id, { method: 'GET' }).then(

			function (response) {
				if (response.status != 200) {
					console.log(response.satus);
					return;
				}
				console.log(response);
				response.json().then(function (n) {
					console.log(n);
					var banners = document.getElementById("banners");
					//创建一个div
					var div = document.createElement("div");
					//设置div的id
// 					div.id = "abc";
					//设置div的class
					div.className = "col-md-12 room";
					//设置style
					//div.style.display="block";
					div.click = "selectbyid()";
					//设置子div的其他属性，直接通过字符串连接的方式连接即可。动态值放在引号外面就行
					div.innerHTML = '<div class="row"><div class="col-md-6">'+
					'<div class="room-img"><img src="' + n.pdpicture + '"></div>'+
					'</div><div class="col-md-6">' +
						'<div class="room-des"><h3>' + n.pdname + '</h3><h1>' + n.pdprice + '</h1>' +
						'<ul class="room-size"><li><i class="fa fa-arrow-right"></i>' + n.pdcontent + '</li>' +
						'<li><i class="fa fa-arrow-right"></i>' + n.pdtype + '</li></ul><div class="room-link">' +
						'<a href="#" onclick="addToCart(' + n.pdid + ')" data-toggle="modal" data-target="#modal-id">加入購物車</a></br><a href="https://localhost:8443/morari/ProductCart/productcartqueryallmain.controller">返回商城</a>' +
						'</div></div></div></div>';

					banners.appendChild(div);

				});
			});
		function selectbyuserid(uid) {
			$.ajax({
				success: function (data) {
					window.location.href = "/morari/ProductCart/queryAllByuserid.controller/" + uid;
				}
			});
		}
		function addToCart(pdid) {
			var data = {
				"pdid": pdid,
				"userid": uid
			};
			$.ajax({
				type: "POST",
				url: "/morari/ProductCart/create.controller",
				data: JSON.stringify(data),
				contentType: "application/json; charset=utf-8",
				dataType: "text",
				success: function (response) {
					alert(response);
					// 成功時的回應處理
				},
				failure: function (error) {
					// 失敗時的錯誤處理
				}
			});
		}
	</script>
</body>

</html>