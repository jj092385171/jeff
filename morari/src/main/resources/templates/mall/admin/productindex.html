<!DOCTYPE html>
<html lang="zh-TW">

<head>
	<script src="/morari/admin/js/head.js"></script>

	<!-- sharepage -->
	<script src="/morari/admin/js/share.js"></script>
	<style>
		td {
			border: 2px black solid;
		}
	</style>
	<script type="text/javascript">
		fetch('/morari/mall/selectAllPd', { method: 'GET' }).then(
			function (response) {
				if (response.status != 200) {
					console.log(response.satus);
					return;
				}
				console.log(response);
				response.json().then(function (n) {

					var tableData =
						"<th>產品編號</th>" + "<th>產品名稱</th>" +
						"<th>會員id</th>" + "<th>品牌名稱</th>" +
						"<th>產品規格</th>" + "<th>類型</th>" +
						"<th>照片</th>" + "<th>產品價格</th>" +
						"<th>產品庫存</th>" + "<th>上架時間</th>" +
						"<th>產品修改時間</th>" + "<th>修改</th>" +
						"<th>刪除</th>";
					for (var i = 0; i < n.length; i++) {
						tableData +=
							"<tr>" +
							"<td>" + n[i].pdid + "</td>" + "<td>" + n[i].pdname + "</td>" +
							"<td>" + n[i].userid + "</td>" + "<td>" + n[i].pdtitle + "</td>" +
							"<td>" + n[i].pdcontent + "</td>" + "<td>" + n[i].pdtype + "</td>" +
							"<td>" + n[i].pdpicture + "</td>" + "<td>" + n[i].pdprice + "</td>" +
							"<td>" + n[i].pdinventory + "</td>" + "<td>" + n[i].pddate + "</td>" +
							"<td>" + n[i].pdlastupdate + "</td>" +

							"<td><button id='update' type='button' value='n[i].pdid' onclick='updateProduct(" + n[i].pdid + ")'>修改</button></td>" +
							"<td><button id='delete' class='morariDelete' type='button' value='n[i].pdid' onclick='confirmDelete(" + n[i].pdid + ")'>刪除</button></td>" +

							"</tr>"

					}
					document.getElementById('result').innerHTML = tableData;
				});

			});

		function confirmDelete(pdid) {
			if (confirm("確定刪除此項產品資料(編號:" + pdid + ")?")) {
				$.ajax({
					url: '/morari/mall/deleteByPdid/' + pdid,
					type: 'delete',
					dataType: 'text',
					success: function (data) {
						alert(data);
						location.reload();
					},
					error: function () {
						// 刪除失敗時的處理
						alert('刪除失敗');
					}

				});
			} else {
			}
		}
		function updateProduct(pdid) {
			if (confirm("確定修改此項產品資料(編號:" + pdid + ")?")) {
				$.ajax({
					success: function (data) {
						window.location.href = "/morari/mall/updateproduct.controller/" + pdid;
					}
				});
			} else {
			}
		}


	</script>

</head>

<body id="page-top" style="display: none">

	<!-- Page Wrapper -->
	<div id="wrapper">
		<!-- sidebar -->
		<div class="sidebarshare"></div>
		<!-- sidebar end -->

		<!-- Content Wrapper -->
		<div id="content-wrapper" class="d-flex flex-column">

			<!-- Main Content -->
			<div id="content">

				<!-- topbar -->
				<div class="topbarshare"></div>
				<!-- topbar end -->

				<!-- Begin Page Content(開始主要內容區塊) -->
				<div class="container-fluid">

					<h3>商城管理</h3>
					<form action="/morari/mall/productcreate.controller" method="GET">
						<input type="submit" value="新增產品">
					</form>
					<table id="result"></table>

				</div>
				<!-- /.container-fluid(結束主要內容區塊) -->

			</div>
			<!-- End of Main Content -->

			<!-- Footer -->
			<div class="footershare"></div>
			<!-- End of Footer -->

		</div>
		<!-- End of Content Wrapper -->

	</div>
	<!-- End of Page Wrapper -->

	<!-- Scroll to Top Button-->
	<a class="scroll-to-top rounded" href="#page-top">
		<i class="fas fa-angle-up"></i>
	</a>

	<!-- Logout Modal-->
	<div class="loginoutshare"></div>

	<!-- Bootstrap core JavaScript-->
	<script src="/morari/admin/vendor/jquery/jquery.min.js" defer></script>
	<script src="/morari/admin/vendor/bootstrap/js/bootstrap.bundle.min.js" defer></script>

	<!-- Core plugin JavaScript-->
	<script src="/morari/admin/vendor/jquery-easing/jquery.easing.min.js" defer></script>

	<!-- Custom scripts for all pages-->
	<script src="/morari/admin/js/sb-admin-2.min.js" defer></script>

	<!-- Page level plugins -->
	<script src="/morari/admin/vendor/chart.js/Chart.min.js" defer></script>

	<!-- Page level custom scripts -->
	<script src="/morari/admin/js/demo/chart-area-demo.js" defer></script>
	<script src="/morari/admin/js/demo/chart-pie-demo.js" defer></script>

</body>

</html>